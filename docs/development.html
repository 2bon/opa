<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Development</title>
  <meta name="description" content="OPA: An open source project to policy enable any application.
">

  <link rel="stylesheet" href="/opa/css/main.css">
  <link rel="canonical" href="http://openpolicyagent.org/opa/docs/development.html">
  <link rel="alternate" type="application/rss+xml" title="Open Policy Agent" href="http://openpolicyagent.org/opa/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/opa/">Open Policy Agent</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/opa/about.html">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/opa/docs/intro.html">Docs</a>
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="docs">

  <div class="docs-nav">
    <ul>
        
        
        
        
        
        
        
        
         
        <li>
          <a class="page-link" href="/opa/docs/intro.html">Introduction</a>
        </li>
        
        
         
        <li>
          <a class="page-link" href="/opa/docs/arch.html">Architecture</a>
        </li>
        
        
         
        <li>
          <a class="page-link" href="/opa/docs/lang.html">Language</a>
        </li>
        
        
         
        <li>
          <a class="page-link" href="/opa/docs/development.html">Development</a>
        </li>
        
        
    </ul>
  </div>
  
  <div class="docs-content">
    <h2 id="development-environment">Development Environment</h2>

<p>OPA is written in the <a href="https://golang.org">Go</a> programming language.</p>

<p>If you are not familiar with Go we recommend you read through the <a href="https://golang.org/doc/code.html">How to Write Go
Code</a> article to familiarize yourself with the standard Go development environment.</p>

<p>Requirements:</p>

<ul>
  <li>Git</li>
  <li>GitHub account (if you are contributing)</li>
  <li>Go (version 1.5.x and 1.6.x are supported)</li>
  <li>GNU Make</li>
</ul>

<h2 id="getting-started">Getting Started</h2>

<p>After cloning the repository, run <code class="highlighter-rouge">make deps</code> to install the parser generator (“pigeon”) into your workspace.</p>

<p>Next, run <code class="highlighter-rouge">make all</code> to build the project, execute all of the tests, and run
static analysis checks against the code. If this succeeds, there should be a
new binary in the top level directory (“opa”).</p>

<p>Verify the build was successful by running <code class="highlighter-rouge">opa version</code>.</p>

<p>You can re-build the project with <code class="highlighter-rouge">make build</code> and execute all of the tests
with <code class="highlighter-rouge">make test</code>.</p>

<p>The static analysis checks (i.e., <code class="highlighter-rouge">go fmt</code>, <code class="highlighter-rouge">golint</code>, and <code class="highlighter-rouge">go vet</code> can be run
with <code class="highlighter-rouge">make check</code>).</p>

<h2 id="workflow">Workflow</h2>

<ol>
  <li>
    <p>Go to <a href="https://github.com/open-policy-agent/opa">https://github.com/open-policy-agent/opa</a> and fork the repository
into your account by clicking the “Fork” button.</p>
  </li>
  <li>
    <p>Clone the fork to your local machine.</p>

    <p><code class="highlighter-rouge">
 cd $GOPATH
 mkdir -p src/github.com/open-policy-agent
 cd src/github.com/open-policy-agent
 git clone git@github.com/&lt;GITHUB USERNAME&gt;/opa.git opa
 cd opa
 git remote add upstream https://github.com/open-policy-agent/opa.git
</code></p>
  </li>
  <li>
    <p>Create a branch for your changes.</p>

    <p><code class="highlighter-rouge">
 git checkout -b somefeature
</code></p>
  </li>
  <li>
    <p>Update your local branch with upstream.</p>

    <p><code class="highlighter-rouge">
 git fetch upstream
 git rebase upstream/master
</code></p>
  </li>
  <li>
    <p>Develop your changes and regularly update your local branch against upstream.</p>

    <ul>
      <li>Be sure to run <code class="highlighter-rouge">make check</code> before submitting your pull request. You
may need to run <code class="highlighter-rouge">go fmt</code> on your code to make it comply with standard Go
style.</li>
    </ul>
  </li>
  <li>
    <p>Commit changes and push to your fork.</p>

    <p><code class="highlighter-rouge">
 git commit
 git push origin somefeature
</code></p>
  </li>
  <li>
    <p>Submit a Pull Request via https://github.com/&lt;GITHUB USERNAME&gt;/opa. You
should be prompted to with a “Compare and Pull Request” button that
mentions your branch.</p>
  </li>
  <li>
    <p>Once your Pull Request has been reviewed and signed off please squash your
commits. If you have a specific reason to leave multiple commits in the
Pull Request, please mention it in the discussion.</p>

    <blockquote>
      <p>If you are not familiar with squashing commits, see <a href="http://gitready.com/advanced/2009/02/10/squashing-commits-with-rebase.html">the following blog post for a good overview</a>.</p>
    </blockquote>
  </li>
</ol>

<h2 id="dependencies">Dependencies</h2>

<p><a href="https://github.com/Masterminds/glide">Glide</a> is a command line tool used for
dependency management. You must have Glide installed in order to add new
dependencies or update existing dependencies. If you are not changing
dependencies you do not have to install Glide, all of the dependencies are
contained in the vendor directory.</p>

<p>If you need to add a dependency to the project:</p>

<ol>
  <li>Run <code class="highlighter-rouge">glide get &lt;package&gt; --update-vendored</code> to download the package.
    <ul>
      <li>This command should be used instead of <code class="highlighter-rouge">go get &lt;package&gt;</code>.</li>
      <li>The package will be stored under the vendor directory.</li>
      <li>The glide.yaml file will be updated.</li>
    </ul>
  </li>
  <li>Manually remove the VCS directories (e.g., .git, .hg, etc.) from the new
vendor directories.</li>
  <li>Commit the changes in glide.yaml, glide.lock, and new vendor directories.</li>
</ol>

<p>If you need to update the dependencies:</p>

<ol>
  <li>Run <code class="highlighter-rouge">glide update --update-vendored</code>.</li>
  <li>Commit the changes to the glide.lock file and any files under the vendor
directory.</li>
</ol>

<h2 id="rego">Rego</h2>

<p>If you need to modify the Rego syntax you must update ast/rego.peg. Both <code class="highlighter-rouge">make build</code> and <code class="highlighter-rouge">make test</code> will re-generate the parser but if you want to test the parser generation explicitly you can run <code class="highlighter-rouge">make generate</code>.</p>

  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      
      <div class="footer-col footer-col-1">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/open-policy-agent/opa"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">open-policy-agent/opa</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <p>OPA: An open source project to policy enable any application.
</p>
      </div>
      
    </div>

  </div>

</footer>


  </body>

</html>
